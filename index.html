<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Dental AI Assistant ‚Äì Ask Dr. Sudip Roy | Jalpaiguri</title>
    <meta name="description" content="Chat with Dr. Sudip Roy‚Äôs Dental AI Assistant. Get basic guidance and book appointments at the main dental clinic in Jalpaiguri.">
    
    <link rel="canonical" href="https://cosmeticdentistjalpaiguriclinic.github.io/">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "MedicalWebApplication",
      "name": "Dr. Roy AI Dental Assistant",
      "url": "https://cosmeticdentistjalpaiguriclinic.github.io/",
      "mainEntityOfPage": { "@type": "WebPage", "@id": "https://cosmeticdentistjalpaiguriclinic.github.io/" },
      "inLanguage": ["en","bn","hi"],
      "medicalSpecialty": "Dentistry",
      "publisher": {
        "@type": "Organization",
        "name": "Dr. Sudip Roy's Cosmetic Dental Clinic",
        "url": "https://dentistjalpaiguri.github.io"
      },
      "author": { "@type": "Person", "name": "Dr. Sudip Roy", "jobTitle": "Cosmetic Dental Surgeon" },
      "areaServed": { "@type": "AdministrativeArea", "name": "Jalpaiguri District, West Bengal" },
      "sameAs": [
        "https://dentistjalpaiguri.github.io",
        "https://www.facebook.com/bestdentalclinic.Jalpaiguridentalclinic.smile",
        "https://www.instagram.com/drsudipsdentalclinic",
        "https://www.youtube.com/@dentistjalpaiguri",
        "https://www.linkedin.com/in/drsudiproy-best-dentalsurgeon-jalpaiguri",
        "https://maps.app.goo.gl/wKr9LJbUsqLs4t9F9"
      ]
    }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600&family=Orbitron:wght@700&family=Space+Mono:wght@400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* --- ORIGINAL NEON THEME --- */
        :root { --dark-bg: #0A0A1A; --neon-blue: #00FFFF; --neon-pink: #FF00FF; }
        body { font-family: 'Space Mono', 'Hind Siliguri', monospace; background: var(--dark-bg); color: var(--neon-blue); min-height: 100vh; display: flex; flex-direction: column; overflow-x: hidden; }
        
        .header-glow { color: white; text-shadow: 0 0 10px var(--neon-pink); font-family: 'Orbitron', sans-serif; }
        .neon-border { border: 2px solid var(--neon-pink); box-shadow: 0 0 10px var(--neon-pink); background: rgba(255, 0, 255, 0.05); }
        .input-style { background: #1A1A3A; border: 1px solid var(--neon-blue); color: white; padding: 10px; border-radius: 4px; outline: none; }
        
        /* CHAT WINDOW */
        .chat-window { width: 100%; max-width: 400px; height: 550px; max-height: 80vh; background: #000; border: 2px solid var(--neon-pink); box-shadow: 0 0 20px var(--neon-pink); display: flex; flex-direction: column; position: relative; transition: all 0.3s ease; margin-top: 20px; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; font-size: 14px; scroll-behavior: smooth; line-height: 1.6; }
        
        .bot-msg { background: #1A1A3A; padding: 10px; border-radius: 4px; margin-bottom: 10px; color: var(--neon-pink); border-left: 3px solid var(--neon-pink); }
        .user-msg { background: #00FFFF; color: #000; padding: 10px; border-radius: 4px; margin-bottom: 10px; text-align: right; border-right: 3px solid white; align-self: flex-end; margin-left: auto; max-width: 80%; }
        
        /* CONTROLS */
        .lang-bar { display: flex; justify-content: center; gap: 10px; padding: 5px; background: #111; border-bottom: 1px solid #333; }
        .lang-btn { background: #222; color: #777; border: 1px solid #444; padding: 2px 10px; font-size: 12px; cursor: pointer; border-radius: 4px; transition: all 0.3s; }
        .lang-btn.active { background: var(--neon-pink); color: white; border-color: white; box-shadow: 0 0 8px var(--neon-pink); }

        .mic-btn { font-size: 20px; background: none; border: none; cursor: pointer; transition: all 0.3s; color: #555; }
        .mic-btn.listening { color: #FF0000; animation: pulse-red 1.5s infinite; transform: scale(1.2); }
        @keyframes pulse-red { 0% { text-shadow: 0 0 0 rgba(255,0,0,0.7); } 70% { text-shadow: 0 0 10px rgba(255,0,0,0); } }

        /* MASTER NETWORK LINKS STYLING */
        .master-links-container { background: #111; padding: 20px; margin-top: 30px; border-top: 1px solid #333; }
        .link-category { margin-bottom: 20px; }
        .link-category h4 { color: var(--neon-pink); font-size: 14px; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .link-grid { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
        .net-link { color: #aaa; font-size: 11px; text-decoration: none; border: 1px solid #333; padding: 6px 10px; border-radius: 4px; display: inline-block; transition: all 0.3s; background: #0a0a0a; }
        .net-link:hover { border-color: var(--neon-blue); color: white; box-shadow: 0 0 8px rgba(0, 255, 255, 0.2); }
        .net-link.primary { border-color: var(--neon-blue); color: white; font-weight: bold; background: #1A1A3A; }
        .net-link.secondary { font-size: 10px; color: #888; border-color: #222; }

        /* SOCIAL PROOF POPUP */
        .proof-notification { position: fixed; bottom: 90px; left: 20px; background: rgba(0, 0, 0, 0.95); border: 1px solid var(--neon-pink); border-left: 4px solid var(--neon-pink); padding: 12px 15px; border-radius: 4px; color: white; font-size: 12px; box-shadow: 0 0 15px rgba(255, 0, 255, 0.3); z-index: 90; display: flex; align-items: center; gap: 12px; opacity: 0; transform: translateY(20px); transition: all 0.5s ease-in-out; pointer-events: none; }
        .proof-notification.active { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .proof-avatar { width: 35px; height: 35px; background: #1A1A3A; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 16px; border: 1px solid var(--neon-pink); color: var(--neon-pink); }

        /* LEAD MODAL */
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .lead-box { background: #1A1A3A; border: 2px solid var(--neon-pink); padding: 25px; border-radius: 10px; width: 90%; max-width: 350px; text-align: center; box-shadow: 0 0 30px var(--neon-pink); animation: popIn 0.3s ease; }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* WHATSAPP FLOAT */
        .whatsapp-float { position: fixed; width: 60px; height: 60px; bottom: 25px; right: 25px; background-color: #25d366; color: #FFF; border-radius: 50px; text-align: center; font-size: 30px; box-shadow: 0px 0px 15px rgba(37, 211, 102, 0.6); z-index: 1000; display: flex; align-items: center; justify-content: center; }

        /* REVIEW SHIELD STYLES */
        .review-box { background: #1A1A3A; border: 2px solid var(--neon-pink); padding: 20px; border-radius: 10px; width: 90%; max-width: 400px; text-align: center; position: relative; box-shadow: 0 0 30px rgba(255,0,255,0.2); }
        .star-rating { font-size: 30px; cursor: pointer; color: #555; transition: color 0.2s; }
        .star-rating span:hover, .star-rating span.active { color: #FFD700; text-shadow: 0 0 10px #FFD700; }
    </style>
</head>
<body class="p-4">

    <header class="text-center py-6">
        <h1 class="text-2xl md:text-3xl header-glow">Dental AI Assistant for Dr. Sudip Roy ‚Äì Jalpaiguri</h1>
        <p class="text-xs md:text-sm mt-1 text-gray-400">AI assistant connected to Dr. Sudip Roy‚Äôs clinic</p>
    </header>

    <main class="flex justify-center w-full">
        <div id="ai-chat-window" class="chat-window">
            <div class="lang-bar">
                <button onclick="setLanguage('en')" id="btn-en" class="lang-btn active" aria-label="Switch language to English">English</button>
                <button onclick="setLanguage('bn')" id="btn-bn" class="lang-btn" aria-label="Switch language to Bangla">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</button>
                <button onclick="setLanguage('hi')" id="btn-hi" class="lang-btn" aria-label="Switch language to Hindi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
            </div>

            <div class="chat-header text-xs py-2 px-3 border-b border-gray-700 bg-gray-900 flex justify-between items-center">
                <span>AI Status: <span class="animate-pulse" style="color: var(--neon-pink);">‚Ä¢ Online</span></span>
                <span class="text-gray-500">Dr. Roy AI v29.0 (Clean)</span>
            </div>
            
            <div id="chatBody" class="chat-body flex flex-col">
                <div class="bot-msg" id="welcome-msg">Hello! I am Dr. Roy's Dental AI Assistant. <br>I am here to help. Ask me anything about your teeth! ü¶∑</div>
            </div>

            <div class="p-3 border-t border-gray-700 bg-gray-900">
                <div class="flex items-center gap-2">
                    <button onclick="toggleVoice()" id="mic-btn" class="mic-btn" title="Speak Now" aria-label="Voice input">üé§</button>
                    <input type="text" id="chat-input" placeholder="Type here..." class="input-style flex-grow mr-2 text-sm" onkeypress="handleChat(event)" autocomplete="off">
                    <button onclick="sendChatFromInput()" class="text-xl px-3 py-1 bg-pink-500 text-white font-bold rounded hover:bg-pink-600 transition">‚û§</button>
                </div>
                <p class="text-[10px] text-gray-500 text-center mt-2">
                    ‚ö†Ô∏è Educational guidance only. Clinical examination is required for diagnosis.
                </p>
            </div>
        </div>
    </main>
    
    <div class="master-links-container max-w-4xl mx-auto text-center rounded-lg">
        <h3 class="text-white font-bold mb-6 text-sm tracking-wider header-glow">THE VERIFIED NETWORK üåê</h3>
        
        <div class="link-category">
            <h4>Official Hubs</h4>
            <div class="link-grid">
                <a href="https://dentistjalpaiguri.github.io" class="net-link primary">üè• Main Clinic Website</a>
                <a href="https://cosmeticdentistjalpaiguriclinic.github.io" class="net-link primary">ü§ñ AI Dental Assistant</a>
                <a href="https://dentistjalpaiguri.github.io/appointment.html" class="net-link primary" style="border-color:#00FF00;">ü¶∑ Book Appointment</a>
            </div>
        </div>

        <div class="link-category">
            <h4>Extended Network</h4>
            <div class="link-grid">
                <a href="https://bestdentistjalpaiguri.github.io" class="net-link secondary" rel="nofollow">Best Dentist Site</a>
                <a href="https://Smilemakeoverjalpaiguri.github.io" class="net-link secondary" rel="nofollow">Smile Makeover</a>
                <a href="https://bestcosmeticdentistjalpaiguri.github.io/" class="net-link secondary" rel="nofollow">Cosmetic Expert</a>
                <a href="https://dentalclinicjalpaiguri.github.io" class="net-link secondary" rel="nofollow">60 Free WebApp</a>
                <a href="https://cosmeticdentistjalpaiguriclinic.github.io" class="net-link secondary" rel="nofollow">AI Clinic Site</a>
                <a href="https://cosmeticdentistinjalpaiguri.github.io" class="net-link secondary" rel="nofollow">Cosmetic Hub</a>
            </div>
        </div>

        <div class="link-category">
            <h4>Social & Verified Profiles</h4>
            <div class="link-grid">
                <a href="https://www.facebook.com/bestdentalclinic.Jalpaiguridentalclinic.smile?mibextid=ZbWKwL" class="net-link">Facebook</a>
                <a href="https://www.instagram.com/drsudipsdentalclinic" class="net-link">Instagram</a>
                <a href="https://www.youtube.com/@dentistjalpaiguri" class="net-link">YouTube</a>
                <a href="https://www.linkedin.com/in/drsudiproy-best-dentalsurgeon-jalpaiguri" class="net-link">LinkedIn</a>
                <a href="https://x.com/SmileJalpaiguri?t=QGkdlX5wu499awopwUDbeQ&s=08" class="net-link" rel="nofollow">X (Twitter)</a>
                <a href="https://www.threads.com/@drsudipsdentalclinic" class="net-link" rel="nofollow">Threads</a>
                <a href="https://in.pinterest.com/dentistjalpaiguri/" class="net-link" rel="nofollow">Pinterest</a>
            </div>
        </div>

        <div class="link-category">
            <h4>Maps & Directories</h4>
            <div class="link-grid">
                <a href="https://maps.app.goo.gl/wKr9LJbUsqLs4t9F9" class="net-link">Google Business</a>
                <a href="https://www.google.com/maps/d/edit?mid=1eddV2IkJyB8SAmbD86hzDoMtyGPps2k&usp=sharing" class="net-link">Google Map</a>
                <a href="https://jsdl.in/DT-99SZ3I1WFPL" class="net-link">JustDial</a>
                <a href="https://www.practo.com/jalpaiguri/doctor/dr-sudip-roy-dentist" class="net-link">Practo Verified</a>
                <a href="https://mappls.com/kz5ohi" class="net-link" rel="nofollow">Mappls 1</a>
                <a href="https://mappls.com/7ji8i8" class="net-link" rel="nofollow">Mappls 2</a>
                <a href="https://dentistJalpaiguri.sulekha.com" class="net-link" rel="nofollow">Sulekha</a>
                <a href="https://bit.ly/DentistJalpaiguri" class="net-link" rel="nofollow">Lybrate</a>
                <a href="https://www.jalpaigurionline.in/business/dr-sudip-roy-sr-consultant-oral-and-cosmetic-dental-surgeon-54163" class="net-link">Jalpaiguri Online</a>
            </div>
        </div>

        <div class="link-category">
            <h4>Research & Wiki (NOFOLLOW)</h4>
            <div class="link-grid">
                <a href="https://medium.com/@DrSudipRoy" class="net-link" rel="nofollow">Medium Blog</a>
                <a href="https://www.slideshare.net/DrSudipRoy4" class="net-link" rel="nofollow">SlideShare</a>
                <a href="https://issuu.com/drsudiproy" class="net-link" rel="nofollow">Issuu</a>
                <a href="https://wikialpha.co/wiki/Dr._Sudip_Roy" class="net-link" rel="nofollow">WikiAlpha</a>
                <a href="https://dentistjalpaiguri.github.io/wiki-dr-sudip-roy.html" class="net-link" rel="nofollow">Dr. Roy Wiki</a>
                <a href="https://en.everybodywiki.com/Dr._Sudip_Roy" class="net-link" rel="nofollow">EverybodyWiki</a>
            </div>
        </div>
    </div>

    <footer class="text-center text-xs mt-4 mb-20">
        <p style="color: #555;">¬© 2025 Dental AI Assistant | Powered by Dr. Sudip Roy</p>
        <p class="text-[10px] text-gray-600 mt-2">AI assistant follows Google review & medical ethics guidelines.</p>
        <p class="text-[10px] text-gray-600 mt-1">Trusted by patients across Jalpaiguri, Dhupguri, Malbazar & Mainaguri.</p>
    </footer>

    <div id="lead-modal" class="modal-overlay">
        <div class="lead-box">
            <h2 class="text-lg font-bold mb-3 text-white">SAVE CONSULTATION üíæ</h2>
            <p class="text-xs text-gray-300 mb-5">To continue chatting and get your treatment plan, please unlock your file.</p>
            <form id="lead-form">
                <input type="text" id="reg-name" placeholder="Name / ‡¶®‡¶æ‡¶Æ" class="input-style w-full mb-3" required>
                <input type="tel" id="reg-phone" placeholder="Phone / ‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" class="input-style w-full mb-3" required>
                <button type="submit" class="w-full py-2 font-bold bg-pink-500 text-white hover:bg-pink-600 transition duration-300 rounded shadow-[0_0_10px_#FF00FF]">UNLOCK NOW üîì</button>
            </form>
        </div>
    </div>

    <div id="review-modal" class="modal-overlay">
        <div class="review-box">
            <span class="absolute top-2 right-4 text-white cursor-pointer text-xl" onclick="closeReviewModal()">‚úñ</span>
            <h3 class="text-white font-bold mb-2">How was your chat?</h3>
            <div class="star-rating">
                <span onclick="handleRating(1)">‚òÖ</span><span onclick="handleRating(2)">‚òÖ</span>
                <span onclick="handleRating(3)">‚òÖ</span><span onclick="handleRating(4)">‚òÖ</span>
                <span onclick="handleRating(5)">‚òÖ</span>
            </div>
            
            <div id="positive-flow" style="display:none; margin-top:15px;">
                <p class="text-[10px] text-gray-400 mb-1">
                    ‚ö†Ô∏è Draft preview only. Please edit and write honestly in your own words.
                </p>
                <textarea id="ai-review-text" class="w-full bg-black text-cyan-400 text-xs p-2 mt-1 border border-gray-600" rows="3">This is only a sample draft. Please edit and describe your own experience in your own words.</textarea>
                <button onclick="copyAndRedirect()" class="w-full mt-2 bg-green-600 text-white text-xs py-2 rounded">üìã Copy & Go to Google</button>
            </div>
            
            <div id="negative-flow" style="display:none; margin-top:15px;">
                <p class="text-xs text-pink-500">Please tell Dr. Roy directly:</p>
                <textarea class="input-style w-full h-16 text-xs mt-2" placeholder="Feedback..."></textarea>
                <button onclick="submitInternalFeedback()" class="w-full mt-2 bg-pink-600 text-white text-xs py-2 rounded">Send Private Feedback</button>
            </div>
        </div>
    </div>

    <div id="social-proof" class="proof-notification">
        <div class="proof-avatar" id="proof-icon">üë§</div>
        <div>
            <p style="margin:0; font-weight:bold; color:var(--neon-pink)" id="proof-name">Name</p>
            <p style="margin:0; color:#ccc; font-size:11px" id="proof-action">Action</p>
        </div>
    </div>

    <a href="https://wa.me/message/Z54ESRHGCT6SH1" class="whatsapp-float" target="_blank" title="Chat on WhatsApp">
       <svg viewBox="0 0 32 32" width="35" height="35" fill="white"><path d="M16,2A13,13,0,0,0,8,25.23L2.92,27l1.9-5A13,13,0,0,0,16,2Z M16,24a10.3,10.3,0,0,1-5.6-1.6l-2.8,1,1-2.7A10.3,10.3,0,1,1,16,24Z"/></svg>
    </a>

    <script>
        const OFFICIAL_APPOINTMENT_URL = "https://dentistjalpaiguri.github.io/appointment.html";
        const GOOGLE_REVIEW_URL = "https://g.page/r/Ca-Y-0BnW8DsEBM/review"; 
        let currentLang = 'en';
        
        let msgCount = 0;
        let isUnlocked = false;
        let authorityShown = false;
        let confidenceLineShown = false;
        let reviewPromptShown = false; 
        let meaningfulReplies = 0; 
        const FREE_LIMIT = 2; 

        // 1Ô∏è‚É£ FIXED VOICE INIT (SINGLE CALL)
        let voicesReady = false;
        let cachedVoices = [];

        function loadVoices() {
            cachedVoices = window.speechSynthesis.getVoices();
            if (cachedVoices.length > 0) {
                voicesReady = true;
            }
        }
        
        if ('speechSynthesis' in window) {
            window.speechSynthesis.onvoiceschanged = loadVoices;
            loadVoices(); 
        }

        // 2. LEAD FORM SUBMIT
        document.getElementById('lead-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('reg-name').value;
            if (name.length < 2) return;
            isUnlocked = true;
            document.getElementById('lead-modal').style.display = 'none';
            const welcome = `Thanks ${name}! Your consultation file is created.`;
            addBotMessage(welcome);
            speakText(welcome);
        });

        // 3. KNOWLEDGE BASE
        const botKnowledge = {
            "doctor": { keywords: ["doctor", "who", "ke"], answers: { en: "<b>Q: Who is the doctor?</b><br>A: üë®‚Äç‚öïÔ∏è <b>Dr. Sudip Roy</b> is a Senior Cosmetic Dental Surgeon with 27+ years of experience.", bn: "üë®‚Äç‚öïÔ∏è <b>‡¶°‡¶É ‡¶∏‡ßÅ‡¶¶‡ßÄ‡¶™ ‡¶∞‡¶æ‡¶Ø‡¶º</b> ‡¶è‡¶ï‡¶ú‡¶® ‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û ‡¶°‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ú‡¶® (‡ß®‡ß≠+ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ)‡•§", hi: "üë®‚Äç‚öïÔ∏è <b>‡§°‡•â. ‡§∏‡•Å‡§¶‡•Ä‡§™ ‡§∞‡•â‡§Ø</b> 27+ ‡§µ‡§∞‡•ç‡§∑‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§µ‡§æ‡§≤‡•á ‡§µ‡§∞‡§ø‡§∑‡•ç‡§† ‡§¶‡§Ç‡§§ ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§ï ‡§π‡•à‡§Ç‡•§" } },
            "location": { keywords: ["where", "location", "address"], answers: { en: "<b>Q: Where is the clinic?</b><br>A: üìç We are located at Pahari Para, Near V-Mart, Jalpaiguri. Easy access from Dhupguri & Malbazar.", bn: "üìç ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶ø‡¶ï ‡¶™‡¶æ‡¶π‡¶æ‡¶°‡¶º‡¶ø ‡¶™‡¶æ‡¶°‡¶º‡¶æ, ‡¶≠‡¶ø-‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá, ‡¶ú‡¶≤‡¶™‡¶æ‡¶á‡¶ó‡ßÅ‡¶°‡¶º‡¶ø‡•§", hi: "üìç ‡§π‡§Æ ‡§™‡§π‡§æ‡§°‡§º‡•Ä ‡§™‡§æ‡§∞‡§æ, ‡§µ‡•Ä-‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•á ‡§™‡§æ‡§∏, ‡§ú‡§≤‡§™‡§æ‡§à‡§ó‡•Å‡§°‡§º‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡§Ç‡•§" } },
            "cost": { keywords: ["cost", "price", "dam"], answers: { en: "<b>Q: What is the cost?</b><br>A: Consultation is ‚Çπ500. We believe in transparent pricing discussed before treatment.", bn: "‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶´‡¶ø ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ‡•§ ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ñ‡¶∞‡¶ö ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶Ü‡¶≤‡ßã‡¶ö‡¶®‡¶æ ‡¶ï‡¶∞‡¶ø‡•§", hi: "‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂ ‡§∂‡•Å‡§≤‡•ç‡§ï ‚Çπ500 ‡§π‡•à‡•§ ‡§π‡§Æ ‡§á‡§≤‡§æ‡§ú ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ñ‡§∞‡•ç‡§ö ‡§™‡§∞ ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§" } },
            "pain": { keywords: ["pain", "hurt", "betha"], answers: { en: "<b>Q: Is the treatment painful?</b><br>A: We have Emergency Slots. Dr. Roy uses computer-controlled anesthesia for painless relief.", bn: "‡¶¨‡ßç‡¶Ø‡¶•‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶á‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡ßá‡¶®‡ßç‡¶∏‡¶ø ‡¶∏‡ßç‡¶≤‡¶ü ‡¶Ü‡¶õ‡ßá‡•§ ‡¶≠‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶®‡ßá‡¶á‡•§", hi: "‡§¶‡§∞‡•ç‡§¶ ‡§®‡§ø‡§µ‡§æ‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡•ç‡§≤‡•â‡§ü ‡§π‡•à‡§Ç‡•§" } },
            "implant": { keywords: ["implant", "missing", "fix"], answers: { en: "<b>Q: What is the best solution for missing teeth?</b><br>A: Dental implants are a long-term solution. Details are explained by Dr. Roy after examination.", bn: "‡¶á‡¶Æ‡¶™‡ßç‡¶≤‡¶æ‡¶®‡ßç‡¶ü ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶‡ßÄ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®‡•§ ‡¶°‡¶É ‡¶∞‡¶æ‡¶Ø‡¶º ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶ú‡¶æ‡¶®‡¶æ‡¶¨‡ßá‡¶®‡•§", hi: "‡§°‡•á‡§Ç‡§ü‡§≤ ‡§á‡§Æ‡•ç‡§™‡•ç‡§≤‡§æ‡§Ç‡§ü ‡§è‡§ï ‡§¶‡•Ä‡§∞‡•ç‡§ò‡§ï‡§æ‡§≤‡§ø‡§ï ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§π‡•à‡•§ ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§°‡•â. ‡§∞‡•â‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∏‡§Æ‡§ù‡§æ‡§è‡§Ç‡§ó‡•á‡•§" } },
            "rct": { keywords: ["rct", "root canal", "canal"], answers: { en: "<b>Q: Is RCT painful?</b><br>A: Modern Single-Sitting RCT is painless and completed in one visit using Rotary instruments.", bn: "‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï RCT ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶¨‡ßç‡¶Ø‡¶•‡¶æ‡¶π‡ßÄ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶¶‡¶ø‡¶®‡ßá‡¶á ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨‡•§", hi: "‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï RCT ‡§¶‡§∞‡•ç‡§¶ ‡§∞‡§π‡§ø‡§§ ‡§π‡•à ‡§î‡§∞ ‡§è‡§ï ‡§π‡•Ä ‡§¨‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡•ã ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§" } }, // 2Ô∏è‚É£ DUPLICATE KEY REMOVED
            "kids": { keywords: ["kid", "child", "baby"], answers: { en: "<b>Q: Do you treat children?</b><br>A: Yes, we have special Pediatric care for milk teeth and preventive fluoride therapy.", bn: "‡¶π‡ßç‡¶Ø‡¶æ‡¶Å, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∂‡¶ø‡¶∂‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶¶‡¶æ‡¶Å‡¶§‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶Ø‡¶§‡ßç‡¶® ‡¶®‡¶ø‡¶á‡•§", hi: "‡§π‡§æ‡§Å, ‡§π‡§Æ ‡§¨‡§ö‡•ç‡§ö‡•ã‡§Ç ‡§ï‡•á ‡§¶‡§æ‡§Ç‡§§‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§á‡§≤‡§æ‡§ú ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§" } },
            "whitening": { keywords: ["white", "yellow", "clean"], answers: { en: "<b>Q: How to whiten yellow teeth?</b><br>A: We offer Laser Teeth Whitening which takes only 45 minutes for instant results.", bn: "‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶≤‡ßá‡¶ú‡¶æ‡¶∞ ‡¶π‡ßã‡¶Ø‡¶º‡¶æ‡¶á‡¶ü‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶ø ‡¶Ø‡¶æ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡ß™‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá ‡¶¶‡¶æ‡¶Å‡¶§ ‡¶∏‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡ßá‡•§", hi: "‡§π‡§Æ ‡§≤‡•á‡§ú‡§∞ ‡§µ‡•ç‡§π‡§æ‡§á‡§ü‡§®‡§ø‡§Ç‡§ó ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã 45 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§" } },
            "braces": { keywords: ["brace", "clip", "aligner"], answers: { en: "<b>Q: Can I straighten teeth without metal?</b><br>A: Yes, we offer Invisible Aligners which are clear and removable.", bn: "‡¶π‡ßç‡¶Ø‡¶æ‡¶Å, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ö‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶á‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶ø‡•§", hi: "‡§π‡§æ‡§Å, ‡§π‡§Æ ‡§á‡§®‡§µ‡§ø‡§ú‡§ø‡§¨‡§≤ ‡§è‡§≤‡§æ‡§á‡§®‡§∞‡•ç‡§∏ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§" } },
            "safety": { keywords: ["safe", "sterile", "hiv"], answers: { en: "<b>Q: Is it safe?</b><br>A: We follow 100% Sterilization using Class-B Autoclave to prevent any infection.", bn: "‡¶Ü‡¶Æ‡¶∞‡¶æ ‡ßß‡ß¶‡ß¶% ‡¶ú‡ßÄ‡¶¨‡¶æ‡¶£‡ßÅ‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶ï‡¶∞‡¶£ ‡¶Æ‡ßá‡¶®‡ßá ‡¶ö‡¶≤‡¶ø‡•§", hi: "‡§π‡§Æ 100% ‡§®‡§∏‡§¨‡§Ç‡§¶‡•Ä ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§" } }
        };

        // 4. EMOTIONAL INTELLIGENCE
        function getEmotionalResponse(text) {
            const t = text.toLowerCase();
            if (t.includes("pain") || t.includes("fear")) return { en: "I understand your pain. Don't worry. üå∏", bn: "‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶∑‡ßç‡¶ü ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶õ‡¶ø‡•§ üå∏", hi: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•á ‡§¶‡§∞‡•ç‡§¶ ‡§ï‡•ã ‡§∏‡§Æ‡§ù ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å‡•§ üå∏" };
            if (t.includes("cost") || t.includes("taka")) return { en: "Budget is important. Let's discuss safely. üí°", bn: "‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ö‡¶ø‡¶®‡ßç‡¶§‡¶æ ‡¶∏‡ßç‡¶¨‡¶æ‡¶≠‡¶æ‡¶¨‡¶ø‡¶ï‡•§ üí°", hi: "‡§™‡•à‡§∏‡•á ‡§ï‡•Ä ‡§ö‡§ø‡§Ç‡§§‡§æ ‡§Ü‡§Æ ‡§π‡•à‡•§ üí°" };
            return null;
        }

        // 5. CHAT LOGIC
        function sendChat(query) {
            const chatBody = document.getElementById('chatBody');
            const uDiv = document.createElement('div');
            uDiv.className = 'user-msg';
            uDiv.textContent = query;
            chatBody.appendChild(uDiv);
            document.getElementById('chat-input').value = '';

            // CHECK LOCK
            if (!isUnlocked && msgCount >= FREE_LIMIT) {
                setTimeout(() => { document.getElementById('lead-modal').style.display = 'flex'; }, 500);
                return;
            }
            msgCount++;

            const emotion = getEmotionalResponse(query);
            let emotionPrefix = emotion ? `<i style="color:#aaa;">${emotion[currentLang]}</i><br><br>` : "";
            const lower = query.toLowerCase();
            let responseText = "";
            let matchFound = false;

            // 3Ô∏è‚É£ REDIRECT UX (SMOOTH DELAY)
            if (lower.includes("book") || lower.includes("appointment")) {
                const redirectMsg = (currentLang === 'en') ? "Redirecting you to the official appointment page..." : (currentLang === 'bn' ? "‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßá‡¶ú‡ßá ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡¶ø..." : "‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§™‡•â‡§á‡§Ç‡§ü‡§Æ‡•á‡§Ç‡§ü ‡§™‡•á‡§ú ‡§™‡§∞ ‡§≤‡•á ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å...");
                addBotMessage(redirectMsg);
                setTimeout(() => {
                    window.location.href = OFFICIAL_APPOINTMENT_URL;
                }, 800);
                
                // If user is not unlocked, show modal anyway to capture lead before they leave (optional strategy)
                if(!isUnlocked) {
                     setTimeout(() => { document.getElementById('lead-modal').style.display = 'flex'; }, 1000);
                }
                return;
            } 
            else {
                // Normal Search
                for (const key in botKnowledge) {
                    if (botKnowledge[key].keywords.some(w => lower.includes(w))) {
                        responseText = botKnowledge[key].answers[currentLang];
                        matchFound = true;
                        break;
                    }
                }
            }
            
            if (matchFound) meaningfulReplies++;
            if (!matchFound) responseText = (currentLang === 'en') ? "I can help with Implants, Pain, or Cost." : "‡¶Ü‡¶Æ‡¶ø ‡¶á‡¶Æ‡¶™‡ßç‡¶≤‡¶æ‡¶®‡ßç‡¶ü ‡¶¨‡¶æ ‡¶¨‡ßç‡¶Ø‡¶•‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø‡•§";

            setTimeout(() => {
                addBotMessage(emotionPrefix + responseText);
                speakText(responseText);
                
                if (!authorityShown) {
                    setTimeout(() => {
                        const authMsg = (currentLang === 'en') ? "‚úÖ All guidance is based on Dr. Sudip Roy‚Äôs 27+ years of clinical experience." : "‚úÖ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶°‡¶É ‡¶∏‡ßÅ‡¶¶‡ßÄ‡¶™ ‡¶∞‡¶æ‡¶Ø‡¶º‡ßá‡¶∞ ‡ß®‡ß≠+ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá‡•§";
                        addBotMessage(`<small style="color:#00FF00">${authMsg}</small>`);
                    }, 1000);
                    authorityShown = true;
                }

                if (!confidenceLineShown && matchFound) {
                    confidenceLineShown = true;
                    setTimeout(() => {
                        addBotMessage(`<i>Most patients first chat here to understand their dental problem, then visit the clinic for confirmation.</i>`);
                    }, 2500);
                }

                if (
                  !reviewPromptShown && 
                  meaningfulReplies >= 2 && 
                  (lower.includes("thank") || lower.includes("helpful") || lower.includes("good"))
                ) {
                  reviewPromptShown = true;
                  setTimeout(showReviewHelper, 1500);
                }
            }, 600);
        }

        function addBotMessage(html) {
            const chatBody = document.getElementById('chatBody');
            const bDiv = document.createElement('div');
            bDiv.className = 'bot-msg';
            bDiv.innerHTML = html;
            chatBody.appendChild(bDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        // 6. REVIEW SHIELD
        function showReviewHelper() {
            const msg = (currentLang === 'en') ? "If you liked our chat, help us with a review:" : "‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶≠‡¶æ‡¶≤‡ßã ‡¶≤‡¶æ‡¶ó‡¶≤‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶¶‡¶ø‡¶®:";
            addBotMessage(`${msg} <br><button onclick="openReviewModal()" style="background:#00FFFF; color:black; padding:5px; border-radius:3px; margin-top:5px; font-weight:bold;">‚≠ê Rate Us</button>`);
        }
        function openReviewModal() { document.getElementById('review-modal').style.display = 'flex'; }
        function closeReviewModal() { document.getElementById('review-modal').style.display = 'none'; }
        
        function handleRating(stars) {
            const starsEl = document.querySelectorAll('.star-rating span');
            starsEl.forEach((s, i) => s.style.color = i < stars ? '#FFD700' : '#555');
            if (stars >= 4) {
                document.getElementById('positive-flow').style.display = 'block';
                document.getElementById('negative-flow').style.display = 'none';
            } else {
                document.getElementById('positive-flow').style.display = 'none';
                document.getElementById('negative-flow').style.display = 'block';
            }
        }
        function copyAndRedirect() {
            navigator.clipboard.writeText(document.getElementById('ai-review-text').value);
            window.open(GOOGLE_REVIEW_URL, '_blank');
        }
        function submitInternalFeedback() { alert("Feedback Sent!"); closeReviewModal(); }

        // 7. VOICE ENGINE (Text: 3 Langs, Output: 2 Langs)
        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${lang}`).classList.add('active');
            const inputs = { en: "Type or Speak...", bn: "‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶¨‡¶≤‡ßÅ‡¶®...", hi: "‡§≤‡§ø‡§ñ‡•á‡§Ç ‡§Ø‡§æ ‡§¨‡•ã‡§≤‡•á‡§Ç..." };
            document.getElementById('chat-input').placeholder = inputs[lang];
        }
        
        function speakText(text) {
            if (!window.speechSynthesis) return;
            if (!voicesReady) {
                setTimeout(() => speakText(text), 400); 
                return;
            }

            const clean = text.replace(/<[^>]*>?/gm, '').slice(0, 240);
            const utterance = new SpeechSynthesisUtterance(clean);

            let preferredLangs = [];
            // FALLBACK LOGIC: Try Bangla -> Hindi -> English
            if (currentLang === 'bn') {
                preferredLangs = ['bn-IN', 'bn_BD', 'bn', 'hi-IN', 'en-IN'];
            } else if (currentLang === 'hi') {
                preferredLangs = ['hi-IN', 'hi', 'en-IN'];
            } else {
                preferredLangs = ['en-IN', 'en-US'];
            }

            let selected = null;
            for (let langCode of preferredLangs) {
                selected = cachedVoices.find(v => v.lang.includes(langCode));
                if (selected) {
                    utterance.lang = selected.lang;
                    utterance.voice = selected;
                    break;
                }
            }
            if (!selected) utterance.lang = 'en-IN'; // Ultimate Fallback

            speechSynthesis.cancel();
            speechSynthesis.speak(utterance);
        }
        
        function toggleVoice() {
            if (!('webkitSpeechRecognition' in window)) { alert("Use Chrome for Voice"); return; }
            const rec = new webkitSpeechRecognition();
            // SAFE HACK: Use Hindi engine for Bangla to prevent silent crashes
            rec.lang = (currentLang === 'bn' || currentLang === 'hi') ? 'hi-IN' : 'en-IN';
            
            document.getElementById('mic-btn').classList.add('listening');
            rec.onresult = e => { 
                document.getElementById('chat-input').value = e.results[0][0].transcript;
                sendChat(e.results[0][0].transcript);
                document.getElementById('mic-btn').classList.remove('listening');
            };
            rec.start();
        }
        function sendChatFromInput() { const v = document.getElementById('chat-input').value; if(v) sendChat(v); }
        function handleChat(e) { if(e.key==='Enter') sendChatFromInput(); }

        // 8. SOCIAL PROOF
        const proofNames = ["Amit (Dhupguri)", "Sneha (Malbazar)", "Rahul (Jalpaiguri)", "Priya (Siliguri)", "Vikram (Mainaguri)"];
        const proofActions = ["booked an appointment", "checked implant cost", "started a consultation"];
        function showSocialProof() {
            const n = document.getElementById('social-proof');
            document.getElementById('proof-name').innerText = proofNames[Math.floor(Math.random()*proofNames.length)];
            document.getElementById('proof-action').innerText = proofActions[Math.floor(Math.random()*proofActions.length)];
            n.classList.add('active');
            setTimeout(() => n.classList.remove('active'), 4000);
        }
        setTimeout(() => { showSocialProof(); setInterval(showSocialProof, 15000); }, 5000);
    </script>
</body>
</html>
